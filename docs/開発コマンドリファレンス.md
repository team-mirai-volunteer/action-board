# 開発コマンドリファレンス

## ローカル開発環境セットアップ
- `supabase start` - ローカルSupabase環境を開始
- `pnpm run db:reset` - データベースリセット + 型生成 + ミッションデータ同期 + シードデータ投入を一括実行
- `pnpm run dev` - Next.js開発サーバーを開始 (localhost:3000)

## コード品質とテスト
- `pnpm run biome:check:write` - Biomeフォーマッターとリンターを自動修正付きで実行
- `pnpm run test` - 全テストを実行 (Jest + Playwright)
- `pnpm run test:unit` - ユニットテストのみ実行 (RLSテストを除く)
- `pnpm run test:supabase` - Supabase (RLS, DB Function) テストのみ実行
- `pnpm run test:e2e` - Playwright E2Eテストを実行
- `pnpm run test:e2e:ui` - デバッグ用UIモードでE2Eテストを実行
- `pnpm run test:e2e:debug` - デバッグモードでE2Eテストを実行
- `pnpm run test:ci:unit` - CI用ユニットテスト (JUnit形式レポート出力)
- `pnpm run test:ci:e2e` - CI用E2EとRLSテスト

## データベース型生成とマイグレーション
- `pnpm run db:reset` - データベースリセット + 型生成 + ミッションデータ同期 + シードデータ投入を一括実行
- `pnpm run db:migrate` - マイグレーション適用 + 型生成
- `pnpm run types` - SupabaseスキーマからTypeScript型を生成 (src/lib/types/supabase.tsに出力し、Biomeでコード整形を実行)
- `npx supabase migration new <migration_name>` - 新しいマイグレーションファイルを作成

## ビルドとデプロイメント
- `pnpm run build` - 本番用Next.jsアプリケーションをビルド
- `pnpm run start` - 本番サーバーを開始
- `pnpm run typecheck` - TypeScriptの型チェックを実行 (ビルドなし)

## ミッションデータ管理
- `pnpm run mission:sync` - YAMLファイルからミッションデータをデータベースに同期
- `pnpm run mission:sync:dry` - ドライラン (変更内容の確認のみ)
- `pnpm run mission:export` - データベースからミッションデータをエクスポート

## ポスターデータ管理
- `pnpm run poster:load-csv` - CSVファイルからポスターデータをロード
- `pnpm run poster:auto-load` - Google Driveから自動ロードして名前をマスク
- `pnpm run poster:auto-load:log` - ログ付きで自動ロード
- `pnpm run poster:clear` - ポスターデータをクリア
- `pnpm run poster:mask-names` - ポスターデータの名前をマスク

## YouTubeデータ管理
- `pnpm --filter @action-board/youtube-data sync` - YouTube動画データをデータベースに同期
- `pnpm --filter @action-board/youtube-data sync:dry` - ドライラン (変更内容の確認のみ)

## その他のスクリプト
- `pnpm run calculate-badges` - バッジの計算スクリプトを実行
- `pnpm run export-users-prefecture` - ユーザーの都道府県データをエクスポート
